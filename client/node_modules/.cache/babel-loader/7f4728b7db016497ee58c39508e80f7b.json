{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\User\\\\OneDrive\\\\Desktop\\\\STEPuHP App\\\\client\\\\src\\\\components\\\\auth\\\\Auth.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useRef } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { useHistory } from \"react-router\";\nimport { adminSignIn } from \"../../actions/admin\";\nimport { mentorSignIn, mentorSignUp } from \"../../actions/mentor\";\nimport { studentSignIn, studentSignUp } from \"../../actions/student\";\nimport ArrowRight from \"../../assets/icons/ArrowRight\";\nimport loginBg from \"../../assets/images/login.png\";\nimport ReCAPTCHA from \"react-google-recaptcha\"; // Ensure this package is installed\n\nimport { toast, ToastContainer } from \"react-toastify\";\nimport { showToast } from \"../toast/toast\";\nimport { Checkbox, FormControlLabel } from \"@mui/material\";\nimport { CSSTransition } from \"react-transition-group\";\nimport ModalOverlay from \"../modal/ModalOverlay\";\nimport ForgotPasswordModal from \"./ForgotPasswordModal\";\nimport { verifyRecaptcha } from \"../../actions\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Auth = ({\n  location\n}) => {\n  _s();\n\n  const [toggleLogin, setToggleLogin] = useState(false);\n  const [fields, setFields] = useState({\n    firstName: \"\",\n    lastName: \"\",\n    middleName: \"\",\n    email: \"\",\n    password: \"\",\n    confirmPassword: \"\",\n    enrollmentNo: \"\",\n    semester: \"\",\n    department: \"\"\n  });\n  const dispatch = useDispatch();\n  const history = useHistory();\n  const validRoles = [\"Admin\", \"Mentor\", \"Mentee\"];\n  useEffect(() => {\n    if (!location.state || !validRoles.includes(location.state.trim())) {\n      showToast(\"error\", \"Invalid role. Redirecting...\", 3000, toast.POSITION.TOP_RIGHT);\n      setTimeout(() => {\n        history.goBack();\n      }, 2000);\n    }\n  }, [location.state, history]);\n\n  const resetFields = () => {\n    setFields({\n      firstName: \"\",\n      lastName: \"\",\n      middleName: \"\",\n      email: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      enrollmentNo: \"\",\n      semester: \"\",\n      department: \"\"\n    });\n  };\n\n  const handleToggle = () => {\n    setToggleLogin(!toggleLogin);\n    resetFields();\n  };\n\n  const handleChange = e => {\n    if (e.target.name === \"semester\" && e.target.value === \"\") return;\n    setFields({ ...fields,\n      [e.target.name]: e.target.value.trim()\n    });\n  };\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n\n    if (!location.state || !validRoles.includes(location.state.trim())) {\n      showToast(\"error\", \"Invalid role selected\", 3000, toast.POSITION.TOP_RIGHT);\n      return;\n    }\n\n    if (toggleLogin === false && !recaptcha) {\n      showToast(\"error\", \"Please complete the reCAPTCHA\", 3000, toast.POSITION.TOP_RIGHT);\n      return;\n    } // Handle different roles and actions based on the toggleLogin state\n\n\n    if (location.state === \"Admin\") {\n      dispatch(adminSignIn(fields, history));\n    } else if (location.state === \"Mentor\") {\n      if (toggleLogin) {\n        if (fields.password !== fields.confirmPassword) {\n          showToast(\"error\", \"Passwords don't match\", 3000, toast.POSITION.TOP_RIGHT);\n          return;\n        }\n\n        dispatch(mentorSignUp(fields, handleToggle));\n      } else {\n        dispatch(mentorSignIn(fields, history));\n      }\n    } else if (location.state === \"Mentee\") {\n      if (toggleLogin) {\n        if (fields.password !== fields.confirmPassword) {\n          showToast(\"error\", \"Passwords don't match\", 3000, toast.POSITION.TOP_RIGHT);\n          return;\n        }\n\n        dispatch(studentSignUp(fields, handleToggle));\n      } else {\n        dispatch(studentSignIn(fields, history));\n      }\n    }\n\n    resetFields();\n  };\n\n  const [recaptcha, setRecaptcha] = useState(false); // Correct reCAPTCHA handling\n\n  const handleCaptchaChange = async val => {\n    if (val) {\n      try {\n        const isValid = await dispatch(verifyRecaptcha(val)); // Ensure `verifyRecaptcha` returns a boolean or handled promise\n\n        setRecaptcha(isValid);\n      } catch (error) {\n        setRecaptcha(false);\n        showToast(\"error\", \"Failed to verify reCAPTCHA. Please try again.\", 3000, toast.POSITION.TOP_RIGHT);\n      }\n    } else {\n      setRecaptcha(false);\n    }\n  };\n\n  const [showPass, setShowPass] = useState(\"password\");\n  const [FPEmail, setFPEmail] = useState({\n    role: location.state,\n    email: \"\"\n  });\n\n  const handlePasswordShowToggle = () => {\n    setShowPass(prev => prev === \"password\" ? \"text\" : \"password\");\n  };\n\n  const [showModal, setShowModal] = useState(false);\n  const modalRef = useRef(null);\n  const overlayRef = useRef(null);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"w-full h-screen flex items-center\",\n    children: [/*#__PURE__*/_jsxDEV(CSSTransition, {\n      nodeRef: overlayRef,\n      in: showModal,\n      timeout: 300,\n      classNames: \"overlay\",\n      unmountOnExit: true,\n      children: /*#__PURE__*/_jsxDEV(ModalOverlay, {\n        nodeRef: overlayRef\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(CSSTransition, {\n      nodeRef: modalRef,\n      in: showModal,\n      timeout: 300,\n      classNames: \"modal\",\n      unmountOnExit: true,\n      children: /*#__PURE__*/_jsxDEV(ForgotPasswordModal, {\n        nodeRef: modalRef,\n        setShowModal: setShowModal,\n        setFPEmail: setFPEmail,\n        FPEmail: FPEmail\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-3 bg-white h-full flex flex-col items-center justify-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-full\",\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          style: {\n            fontSize: \"36px\"\n          },\n          className: \"w-full text-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-teal-500\",\n            children: location.state\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 25\n          }, this), \" \", toggleLogin ? \"Sign up\" : \"Sign in\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: loginBg,\n        alt: \"\",\n        className: \"w-1/2\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex-2 bg-teal-600 h-full flex items-center justify-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-96\",\n        children: [/*#__PURE__*/_jsxDEV(\"form\", {\n          className: \"\",\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center mb-6\",\n            children: /*#__PURE__*/_jsxDEV(ReCAPTCHA, {\n              sitekey: \"YOUR_SITE_KEY\" // Replace with your actual site key\n              ,\n              onChange: handleCaptchaChange\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"flex items-center justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"button\",\n              onClick: () => setShowModal(true),\n              className: \"text-teal-300\",\n              children: \"Forgot Password?\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 184,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              type: \"submit\",\n              className: \"bg-gradient-to-r from-teal-400 to-teal-600 text-white font-bold rounded-lg py-3 px-6 shadow-md hover:shadow-lg transition duration-300 ease-in-out\",\n              children: [toggleLogin ? \"Sign Up\" : \"Sign In\", /*#__PURE__*/_jsxDEV(ArrowRight, {\n                className: \"inline-block ml-2\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 192,\n                columnNumber: 33\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 187,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(ToastContainer, {\n          limit: 5,\n          draggable: false,\n          pauseOnFocusLoss: false\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 140,\n    columnNumber: 9\n  }, this);\n};\n\n_s(Auth, \"LWV87R+KqrYtSrkbCXp+wawaKEM=\", false, function () {\n  return [useDispatch, useHistory];\n});\n\n_c = Auth;\nexport default Auth;\n\nvar _c;\n\n$RefreshReg$(_c, \"Auth\");","map":{"version":3,"sources":["C:/Users/User/OneDrive/Desktop/STEPuHP App/client/src/components/auth/Auth.js"],"names":["React","useState","useEffect","useRef","useDispatch","useHistory","adminSignIn","mentorSignIn","mentorSignUp","studentSignIn","studentSignUp","ArrowRight","loginBg","ReCAPTCHA","toast","ToastContainer","showToast","Checkbox","FormControlLabel","CSSTransition","ModalOverlay","ForgotPasswordModal","verifyRecaptcha","Auth","location","toggleLogin","setToggleLogin","fields","setFields","firstName","lastName","middleName","email","password","confirmPassword","enrollmentNo","semester","department","dispatch","history","validRoles","state","includes","trim","POSITION","TOP_RIGHT","setTimeout","goBack","resetFields","handleToggle","handleChange","e","target","name","value","handleSubmit","preventDefault","recaptcha","setRecaptcha","handleCaptchaChange","val","isValid","error","showPass","setShowPass","FPEmail","setFPEmail","role","handlePasswordShowToggle","prev","showModal","setShowModal","modalRef","overlayRef","fontSize"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { useHistory } from \"react-router\";\nimport { adminSignIn } from \"../../actions/admin\";\nimport { mentorSignIn, mentorSignUp } from \"../../actions/mentor\";\nimport { studentSignIn, studentSignUp } from \"../../actions/student\";\nimport ArrowRight from \"../../assets/icons/ArrowRight\";\nimport loginBg from \"../../assets/images/login.png\";\nimport ReCAPTCHA from \"react-google-recaptcha\"; // Ensure this package is installed\nimport { toast, ToastContainer } from \"react-toastify\";\nimport { showToast } from \"../toast/toast\";\nimport { Checkbox, FormControlLabel } from \"@mui/material\";\nimport { CSSTransition } from \"react-transition-group\";\nimport ModalOverlay from \"../modal/ModalOverlay\";\nimport ForgotPasswordModal from \"./ForgotPasswordModal\";\nimport { verifyRecaptcha } from \"../../actions\";\n\nconst Auth = ({ location }) => {\n    const [toggleLogin, setToggleLogin] = useState(false);\n    const [fields, setFields] = useState({\n        firstName: \"\",\n        lastName: \"\",\n        middleName: \"\",\n        email: \"\",\n        password: \"\",\n        confirmPassword: \"\",\n        enrollmentNo: \"\",\n        semester: \"\",\n        department: \"\",\n    });\n    const dispatch = useDispatch();\n    const history = useHistory();\n\n    const validRoles = [\"Admin\", \"Mentor\", \"Mentee\"];\n\n    useEffect(() => {\n        if (!location.state || !validRoles.includes(location.state.trim())) {\n            showToast(\"error\", \"Invalid role. Redirecting...\", 3000, toast.POSITION.TOP_RIGHT);\n            setTimeout(() => {\n                history.goBack();\n            }, 2000);\n        }\n    }, [location.state, history]);\n\n    const resetFields = () => {\n        setFields({\n            firstName: \"\",\n            lastName: \"\",\n            middleName: \"\",\n            email: \"\",\n            password: \"\",\n            confirmPassword: \"\",\n            enrollmentNo: \"\",\n            semester: \"\",\n            department: \"\",\n        });\n    };\n\n    const handleToggle = () => {\n        setToggleLogin(!toggleLogin);\n        resetFields();\n    };\n\n    const handleChange = (e) => {\n        if (e.target.name === \"semester\" && e.target.value === \"\") return;\n        setFields({ ...fields, [e.target.name]: e.target.value.trim() });\n    };\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        if (!location.state || !validRoles.includes(location.state.trim())) {\n            showToast(\"error\", \"Invalid role selected\", 3000, toast.POSITION.TOP_RIGHT);\n            return;\n        }\n        if (toggleLogin === false && !recaptcha) {\n            showToast(\"error\", \"Please complete the reCAPTCHA\", 3000, toast.POSITION.TOP_RIGHT);\n            return;\n        }\n\n        // Handle different roles and actions based on the toggleLogin state\n        if (location.state === \"Admin\") {\n            dispatch(adminSignIn(fields, history));\n        } else if (location.state === \"Mentor\") {\n            if (toggleLogin) {\n                if (fields.password !== fields.confirmPassword) {\n                    showToast(\"error\", \"Passwords don't match\", 3000, toast.POSITION.TOP_RIGHT);\n                    return;\n                }\n                dispatch(mentorSignUp(fields, handleToggle));\n            } else {\n                dispatch(mentorSignIn(fields, history));\n            }\n        } else if (location.state === \"Mentee\") {\n            if (toggleLogin) {\n                if (fields.password !== fields.confirmPassword) {\n                    showToast(\"error\", \"Passwords don't match\", 3000, toast.POSITION.TOP_RIGHT);\n                    return;\n                }\n                dispatch(studentSignUp(fields, handleToggle));\n            } else {\n                dispatch(studentSignIn(fields, history));\n            }\n        }\n\n        resetFields();\n    };\n\n    const [recaptcha, setRecaptcha] = useState(false);\n\n    // Correct reCAPTCHA handling\n    const handleCaptchaChange = async (val) => {\n        if (val) {\n            try {\n                const isValid = await dispatch(verifyRecaptcha(val)); // Ensure `verifyRecaptcha` returns a boolean or handled promise\n                setRecaptcha(isValid);\n            } catch (error) {\n                setRecaptcha(false);\n                showToast(\"error\", \"Failed to verify reCAPTCHA. Please try again.\", 3000, toast.POSITION.TOP_RIGHT);\n            }\n        } else {\n            setRecaptcha(false);\n        }\n    };\n\n    const [showPass, setShowPass] = useState(\"password\");\n    const [FPEmail, setFPEmail] = useState({\n        role: location.state,\n        email: \"\",\n    });\n\n    const handlePasswordShowToggle = () => {\n        setShowPass((prev) => (prev === \"password\" ? \"text\" : \"password\"));\n    };\n\n    const [showModal, setShowModal] = useState(false);\n    const modalRef = useRef(null);\n    const overlayRef = useRef(null);\n\n    return (\n        <div className=\"w-full h-screen flex items-center\">\n            <CSSTransition\n                nodeRef={overlayRef}\n                in={showModal}\n                timeout={300}\n                classNames=\"overlay\"\n                unmountOnExit\n            >\n                <ModalOverlay nodeRef={overlayRef} />\n            </CSSTransition>\n            <CSSTransition\n                nodeRef={modalRef}\n                in={showModal}\n                timeout={300}\n                classNames=\"modal\"\n                unmountOnExit\n            >\n                <ForgotPasswordModal\n                    nodeRef={modalRef}\n                    setShowModal={setShowModal}\n                    setFPEmail={setFPEmail}\n                    FPEmail={FPEmail}\n                />\n            </CSSTransition>\n            <div className=\"flex-3 bg-white h-full flex flex-col items-center justify-center\">\n                <div className=\"w-full\">\n                    <h1 style={{ fontSize: \"36px\" }} className=\"w-full text-center\">\n                        <span className=\"text-teal-500\">{location.state}</span>{\" \"}\n                        {toggleLogin ? \"Sign up\" : \"Sign in\"}\n                    </h1>\n                </div>\n                <img src={loginBg} alt=\"\" className=\"w-1/2\" />\n            </div>\n            <div className=\"flex-2 bg-teal-600 h-full flex items-center justify-center\">\n                <div className=\"w-96\">\n                    <form className=\"\" onSubmit={handleSubmit}>\n                        {/* Add reCAPTCHA Element */}\n                        <div className=\"flex items-center mb-6\">\n                            <ReCAPTCHA\n                                sitekey=\"YOUR_SITE_KEY\" // Replace with your actual site key\n                                onChange={handleCaptchaChange}\n                            />\n                        </div>\n                        <div className=\"flex items-center justify-between\">\n                            <button type=\"button\" onClick={() => setShowModal(true)} className=\"text-teal-300\">\n                                Forgot Password?\n                            </button>\n                            <button\n                                type=\"submit\"\n                                className=\"bg-gradient-to-r from-teal-400 to-teal-600 text-white font-bold rounded-lg py-3 px-6 shadow-md hover:shadow-lg transition duration-300 ease-in-out\"\n                            >\n                                {toggleLogin ? \"Sign Up\" : \"Sign In\"}\n                                <ArrowRight className=\"inline-block ml-2\" />\n                            </button>\n                        </div>\n                    </form>\n                    <ToastContainer limit={5} draggable={false} pauseOnFocusLoss={false} />\n                </div>\n            </div>\n        </div>\n    );\n};\n\nexport default Auth;\n"]},"metadata":{},"sourceType":"module"}